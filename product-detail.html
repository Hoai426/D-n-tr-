<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√† D∆∞·ª°ng T√¢m | H√†nh Tr√¨nh An Y√™n</title>
    <link rel="stylesheet" href="product.css">
</head>
<body>
    <!-- Navigation -->
        <nav class="product-nav">
        <a href="index.html" class="back-btn">
            <span>‚Üê</span> V·ªÅ trang ch·ªß
        </a>
        <div class="nav-spirit">
            <div class="spirit-mini" id="nav-spirit-icon">üå∫</div>
            <span id="current-spirit-name">T√¢m Hoa ƒë·ªìng h√†nh c√πng b·∫°n</span>
        </div>
            <!-- Floating controls for product page: music, cart, favorite -->
            <!-- Buttons moved out to body so CSS fixed corner positions apply consistently -->
    </nav>

    <!-- Floating controls (fixed position in CSS) -->
    <button id="music-toggle" class="music-btn" aria-label="B·∫≠t/T·∫Øt nh·∫°c">üéµ</button>
    <button id="cart-toggle" class="cart-btn" aria-label="T√∫i An Y√™n">üëú</button>
    <button id="favorite-toggle" class="fav-btn" aria-pressed="false" aria-label="Y√™u th√≠ch">üíó</button>

    <!-- Product Hero Section -->
    <section class="product-hero">
        <div class="hero-background" id="hero-background">
            <div class="mood-particles" id="mood-particles"></div>
            <div class="floating-ingredients" id="floating-ingredients">
                <!-- Ingredients s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
            </div>
        </div>
        
        <div class="hero-content">
            <div class="product-visual">
                <div class="tea-jar-container">
                    <img src="assets/images/products/tea-duong-tam.png" alt="" class="tea-jar" id="main-product-image"
                         onerror="this.style.display='none'; document.querySelector('.jar-placeholder').style.display='flex';">
                    
                    <!-- Placeholder khi h√¨nh ·∫£nh kh√¥ng t·∫£i ƒë∆∞·ª£c -->
                    <div class="jar-placeholder">
                        <div class="placeholder-icon" id="placeholder-icon">üå∫</div>
                        <div class="placeholder-text" id="placeholder-text">Tr√† D∆∞·ª°ng T√¢m</div>
                    </div>
                    
                    <div class="jar-glow" id="jar-glow"></div>
                    <div class="spirit-interaction">
                        <div class="spirit-touch" id="spirit-touch">üå∫</div>
                    </div>
                </div>

                <!-- Product Gallery -->
                <div class="product-gallery">
                    <div class="gallery-item active" data-image="1">
                        <img src="assets/images/products/tea-ngu-ngon (2).png" alt="G√≥c nh√¨n 1" class="gallery-image" onerror="this.style.display='none'">
                        <div class="gallery-placeholder">üå∫</div>
                    </div>
                    <div class="gallery-item" data-image="2">
                        <img src="assets/images/products/tea-ngu-ngon (2).png" alt="G√≥c nh√¨n 2" class="gallery-image" onerror="this.style.display='none'">
                        <div class="gallery-placeholder">üçµ</div>
                    </div>
                    <div class="gallery-item" data-image="3">
                        <img src="assets/images/products/tea-ngu-ngon (2).png" alt="G√≥c nh√¨n 3" class="gallery-image" onerror="this.style.display='none'">
                        <div class="gallery-placeholder">üåø</div>
                    </div>
                </div>
            </div>
            
            <div class="product-info">
                <div class="mood-badge" id="mood-badge">
                    üå∫ Mood D∆∞·ª°ng T√¢m
                </div>
                
                <h1 class="product-title" id="product-title">Tr√† D∆∞·ª°ng T√¢m</h1>
                <p class="product-tagline" id="product-tagline">D·ªãu √™m t√¢m h·ªìn, ·∫•m √°p tr√°i tim</p>
                
                <div class="product-rating">
                    <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                    <span class="rating-text" id="rating-text">5.0 (128 ƒë√°nh gi√°)</span>
                </div>

                <div class="price-section">
                    <div class="current-price" id="current-price">45.000 ‚Ç´</div>
                    <div class="original-price" id="original-price">45.000 ‚Ç´</div>
                </div>

                <div class="spirit-message-card">
                    <div class="spirit-avatar" id="spirit-avatar">üå∫</div>
                    <div class="message-content">
                        <p class="message" id="spirit-message">"Tr√°i tim b·∫°n ƒëang c·∫ßn ƒë∆∞·ª£c chƒÉm s√≥c. H√£y ƒë·ªÉ T√¢m Hoa d·∫´n b·∫°n v·ªÅ s·ª± thanh l·ªçc v√† an h√≤a."</p>
                        <span class="spirit-name" id="spirit-name">- T√¢m Hoa</span>
                    </div>
                </div>

                <div class="action-section">
                    <div class="quantity-selector">
                        <button class="qty-btn minus">-</button>
                        <span class="qty-display">1</span>
                        <button class="qty-btn plus">+</button>
                    </div>
                    
                    <button class="btn-add-to-cart" id="add-to-cart-btn">
                        <span class="btn-icon">üõí</span>
                        <span class="btn-text">Th√™m v√†o T√∫i An Y√™n</span>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Details -->
    <section class="product-details">
        <div class="details-container">
            <!-- Benefits -->
            <div class="detail-card">
                <h3 id="benefits-title">‚ú® L·ª£i √çch T√¢m H·ªìn</h3>
                <ul class="benefits-list" id="benefits-list">
                    <!-- Benefits s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                </ul>
            </div>

            <!-- Ingredients -->
            <div class="detail-card">
                <h3 id="ingredients-title">üå± Th√†nh Ph·∫ßn T·ª± Nhi√™n</h3>
                <div class="ingredients-grid" id="ingredients-grid">
                    <!-- Ingredients s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                </div>
            </div>

            <!-- Brewing Guide -->
            <div class="detail-card">
                <h3>ü´ñ C√°ch Pha Ho√†n H·∫£o</h3>
                <div class="brewing-steps">
                    <div class="brew-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <strong>Chu·∫©n b·ªã</strong>
                            <p id="brew-step-1">Cho 2-3g tr√† v√†o ·∫•m, tr√°ng qua n∆∞·ªõc ·∫•m 85¬∞C</p>
                        </div>
                    </div>
                    <div class="brew-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <strong>·ª¶ tr√†</strong>
                            <p id="brew-step-2">ƒê·ªï n∆∞·ªõc 85¬∞C ng·∫≠p tr√†, ·ªß trong 3-5 ph√∫t</p>
                        </div>
                    </div>
                    <div class="brew-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <strong>Th∆∞·ªüng th·ª©c</strong>
                            <p id="brew-step-3">R√≥t tr√† ra t√°ch, h√≠t h√† h∆∞∆°ng th∆°m v√† th∆∞·ªüng th·ª©c</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Products -->
            <div class="detail-card">
                <h3>üåø C√°c Lo·∫°i Tr√† Kh√°c</h3>
                <div class="other-products-grid" id="other-products">
                    <!-- C√°c s·∫£n ph·∫©m kh√°c s·∫Ω ƒë∆∞·ª£c th√™m b·∫±ng JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <!-- Spirit Companion -->
    <div class="spirit-companion product-companion">
        <div class="spirit-character" id="spirit-character">
            <div class="spirit-dialogue">
                <p id="spirit-dialogue">M·ªói t√°ch tr√† l√† m·ªôt c√°i √¥m ·∫•m √°p cho t√¢m h·ªìn b·∫°n üíñ</p>
            </div>
        </div>
    </div>

    <script src="product.js"></script>
    <audio id="background-music" loop>
        <source src="assets/audio/meditation-sound (2).mp3" type="audio/mpeg">
    </audio>
    <script>
        // small script to initialize controls on product page
        const musicBtnPd = document.getElementById('music-toggle');
        const cartBtnPd = document.getElementById('cart-toggle');
        const favBtnPd = document.getElementById('favorite-toggle');
        const audioPd = document.getElementById('background-music');
        if (musicBtnPd && audioPd) {
            let isPlaying = localStorage.getItem('tg_music') === '1';
            musicBtnPd.setAttribute('aria-pressed', String(isPlaying));
            musicBtnPd.addEventListener('click', ()=>{
                isPlaying = !isPlaying;
                if (isPlaying) audioPd.play().catch(()=>{}); else audioPd.pause();
                musicBtnPd.setAttribute('aria-pressed', String(isPlaying));
                localStorage.setItem('tg_music', isPlaying ? '1':'0');
            });
        }
        if (cartBtnPd) cartBtnPd.addEventListener('click', ()=> window.location.href='cart.html');
        if (favBtnPd) {
            const favState = localStorage.getItem('tg_favorite') === '1';
            favBtnPd.setAttribute('aria-pressed', String(favState));
            if (favState) favBtnPd.textContent = 'üíñ';
            favBtnPd.addEventListener('click', ()=>{
                const p = favBtnPd.getAttribute('aria-pressed') === 'true';
                favBtnPd.setAttribute('aria-pressed', String(!p));
                favBtnPd.textContent = (!p) ? 'üíñ' : 'üíó';
                localStorage.setItem('tg_favorite', (!p) ? '1':'0');
            });
        }
        // update cart count badge on product detail page
        const updatePdCartCount = () => {
            const cart = JSON.parse(localStorage.getItem('teaCart')) || [];
            const count = cart.reduce((s, i) => s + (i.quantity || 0), 0);
            let badge = cartBtnPd.querySelector('.cart-badge');
            if (!badge) {
                badge = document.createElement('span');
                badge.className = 'cart-badge';
                badge.style.cssText = 'position:absolute;top:-6px;right:-6px;background:#ff6b6b;color:#fff;border-radius:9999px;padding:2px 6px;font-size:12px;';
                cartBtnPd.style.position = 'relative';
                cartBtnPd.appendChild(badge);
            }
            badge.textContent = count > 0 ? count : '';
        };

        updatePdCartCount();
        window.addEventListener('cartUpdated', updatePdCartCount);
    </script>
    <!-- Lightbox modal for large product images -->
    <div id="lightbox" class="lightbox hidden" role="dialog" aria-modal="true" aria-label="H√¨nh ·∫£nh s·∫£n ph·∫©m l·ªõn">
        <button id="lightboxClose" class="lightbox-close" aria-label="ƒê√≥ng">‚úï</button>
        <button id="lightboxPrev" class="lightbox-nav left" aria-label="H√¨nh tr∆∞·ªõc">‚óÄ</button>
        <div class="lightbox-content">
            <img id="lightboxImage" src="" alt="H√¨nh ·∫£nh l·ªõn s·∫£n ph·∫©m">
        </div>
        <button id="lightboxNext" class="lightbox-nav right" aria-label="H√¨nh ti·∫øp theo">‚ñ∂</button>
    </div>
</body>
</html>